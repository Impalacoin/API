VERSION 5.00
Object = "{248DD890-BB45-11CF-9ABC-0080C7E7B78D}#1.0#0"; "MSWINSCK.OCX"
Begin VB.Form Form1 
   BackColor       =   &H00C0C0C0&
   Caption         =   "Merchant Emserv"
   ClientHeight    =   9150
   ClientLeft      =   165
   ClientTop       =   555
   ClientWidth     =   9630
   FillColor       =   &H00FF00FF&
   Icon            =   "Form1.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   Picture         =   "Form1.frx":030A
   ScaleHeight     =   9150
   ScaleWidth      =   9630
   StartUpPosition =   3  'Windows Default
   Begin MSWinsockLib.Winsock Winsock1 
      Left            =   360
      Top             =   840
      _ExtentX        =   741
      _ExtentY        =   741
      _Version        =   393216
   End
   Begin VB.TextBox Text9 
      Height          =   375
      Left            =   5280
      TabIndex        =   74
      Top             =   7200
      Width           =   1695
   End
   Begin VB.TextBox Text23 
      Height          =   375
      Left            =   7320
      MaxLength       =   3
      TabIndex        =   64
      Text            =   "254"
      Top             =   720
      Width           =   1935
   End
   Begin VB.Timer Timer2 
      Interval        =   250
      Left            =   6600
      Top             =   360
   End
   Begin VB.Frame Frame3 
      BackColor       =   &H00C0C000&
      Caption         =   "Source Network Settings  (Transaction Initiator Network)"
      Height          =   1695
      Left            =   240
      TabIndex        =   15
      Top             =   0
      Width           =   9135
      Begin VB.TextBox Text24 
         Height          =   375
         Left            =   7080
         MaxLength       =   3
         TabIndex        =   66
         Text            =   "404"
         Top             =   1200
         Width           =   1935
      End
      Begin VB.TextBox Text22 
         Height          =   375
         Left            =   7080
         MaxLength       =   50
         TabIndex        =   62
         Text            =   "KENYA"
         Top             =   240
         Width           =   1935
      End
      Begin VB.CommandButton Command1 
         BackColor       =   &H00FFFFC0&
         Caption         =   "Apply Settings"
         Height          =   375
         Left            =   2760
         MaskColor       =   &H00C0FFC0&
         Style           =   1  'Graphical
         TabIndex        =   22
         Top             =   1200
         Width           =   1215
      End
      Begin VB.TextBox Text8 
         Height          =   375
         Left            =   1320
         TabIndex        =   20
         Text            =   "2305"
         Top             =   1200
         Width           =   1335
      End
      Begin VB.TextBox Text7 
         Height          =   375
         Left            =   1320
         TabIndex        =   19
         Text            =   "127.0.0.1"
         Top             =   720
         Width           =   2655
      End
      Begin VB.TextBox Text6 
         Height          =   375
         Left            =   1320
         MaxLength       =   15
         TabIndex        =   17
         Text            =   "254000000000001"
         Top             =   240
         Width           =   2655
      End
      Begin VB.Label Label14 
         BackColor       =   &H00C0C000&
         Caption         =   "Transaction Source ISO Currency Code"
         Height          =   255
         Left            =   4200
         TabIndex        =   67
         Top             =   1300
         Width           =   2895
      End
      Begin VB.Label Label13 
         BackColor       =   &H00C0C000&
         Caption         =   "Transaction Source Country Code"
         Height          =   255
         Left            =   4200
         TabIndex        =   65
         Top             =   840
         Width           =   2535
      End
      Begin VB.Label Label12 
         BackColor       =   &H00C0C000&
         Caption         =   "Transaction Source Country"
         Height          =   255
         Left            =   4200
         TabIndex        =   63
         Top             =   360
         Width           =   2175
      End
      Begin VB.Label Label6 
         BackColor       =   &H00C0C000&
         Caption         =   "Host Port"
         Height          =   255
         Left            =   120
         TabIndex        =   21
         Top             =   1320
         Width           =   1095
      End
      Begin VB.Label Label5 
         BackColor       =   &H00C0C000&
         Caption         =   "Host IP"
         Height          =   255
         Left            =   120
         TabIndex        =   18
         Top             =   720
         Width           =   1215
      End
      Begin VB.Label Label1 
         BackColor       =   &H00C0C000&
         Caption         =   "Merchant ID"
         Height          =   255
         Left            =   120
         TabIndex        =   16
         Top             =   240
         Width           =   1095
      End
   End
   Begin VB.Frame Frame1 
      BackColor       =   &H00E0E0E0&
      Caption         =   "TRANSACTION SUMMARY"
      ForeColor       =   &H00FF0000&
      Height          =   4815
      Left            =   240
      TabIndex        =   3
      Top             =   2040
      Width           =   9135
      Begin VB.CommandButton Command11 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Transfer Fund (C2C)"
         Enabled         =   0   'False
         Height          =   615
         Left            =   240
         Style           =   1  'Graphical
         TabIndex        =   59
         Top             =   1800
         Width           =   1575
      End
      Begin VB.Frame Frame6 
         BackColor       =   &H00E0E0E0&
         Caption         =   "C 2 C Money Transfer"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C000C0&
         Height          =   3975
         Left            =   5280
         TabIndex        =   51
         Top             =   600
         Visible         =   0   'False
         Width           =   4095
         Begin VB.TextBox Text21 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   3
            TabIndex        =   61
            Top             =   1560
            Width           =   1575
         End
         Begin VB.TextBox Text20 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   10
            TabIndex        =   55
            Top             =   600
            Width           =   1575
         End
         Begin VB.TextBox Text19 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   10
            TabIndex        =   54
            Top             =   1080
            Width           =   1575
         End
         Begin VB.TextBox Text18 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   10
            TabIndex        =   53
            Top             =   2160
            Width           =   1575
         End
         Begin VB.CommandButton Command10 
            BackColor       =   &H00FFFF80&
            Caption         =   "Submit"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   495
            Left            =   1680
            Style           =   1  'Graphical
            TabIndex        =   52
            Top             =   3360
            Width           =   1575
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Recipient Country Code"
            ForeColor       =   &H80000008&
            Height          =   495
            Index           =   15
            Left            =   120
            TabIndex        =   60
            Top             =   1560
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Sender Mobile Number"
            ForeColor       =   &H80000008&
            Height          =   495
            Index           =   14
            Left            =   120
            TabIndex        =   58
            Top             =   480
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Recipient Phone"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   13
            Left            =   120
            TabIndex        =   57
            Top             =   1080
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Transfer Amount"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   12
            Left            =   120
            TabIndex        =   56
            Top             =   2160
            Width           =   1455
         End
      End
      Begin VB.CommandButton Command7 
         BackColor       =   &H00FFC0FF&
         Caption         =   "Authorization Request"
         Height          =   615
         Left            =   240
         Style           =   1  'Graphical
         TabIndex        =   25
         Top             =   2400
         Width           =   1575
      End
      Begin VB.CommandButton Command6 
         BackColor       =   &H00C0E0FF&
         Caption         =   "Eval Change Topup"
         Enabled         =   0   'False
         Height          =   615
         Left            =   240
         Style           =   1  'Graphical
         TabIndex        =   24
         Top             =   3000
         Width           =   1575
      End
      Begin VB.CommandButton Command5 
         BackColor       =   &H00C0FFC0&
         Caption         =   "Eval Registration"
         Enabled         =   0   'False
         Height          =   615
         Left            =   240
         Style           =   1  'Graphical
         TabIndex        =   23
         Top             =   3600
         Width           =   1575
      End
      Begin VB.CommandButton Command4 
         BackColor       =   &H00FFFF00&
         Caption         =   "CWD / CAD (C2A)"
         Enabled         =   0   'False
         Height          =   615
         Left            =   240
         Style           =   1  'Graphical
         TabIndex        =   14
         Top             =   1200
         Width           =   1575
      End
      Begin VB.Frame Frame2 
         BackColor       =   &H00E0E0E0&
         Caption         =   "Agent/ATM Cash CWD/CAD "
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C000C0&
         Height          =   3975
         Left            =   5280
         TabIndex        =   6
         Top             =   600
         Visible         =   0   'False
         Width           =   4095
         Begin VB.CheckBox Check2 
            BackColor       =   &H00E0E0E0&
            Caption         =   "ATM"
            Height          =   255
            Left            =   600
            TabIndex        =   73
            Top             =   2880
            Width           =   1095
         End
         Begin VB.CheckBox Check1 
            BackColor       =   &H00E0E0E0&
            Caption         =   "Agent"
            Height          =   195
            Left            =   600
            TabIndex        =   72
            Top             =   2520
            Width           =   1095
         End
         Begin VB.TextBox Text25 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   10
            TabIndex        =   70
            Top             =   1920
            Width           =   1575
         End
         Begin VB.OptionButton Option2 
            BackColor       =   &H00E0E0E0&
            Caption         =   "Deposit"
            Height          =   255
            Left            =   1800
            TabIndex        =   69
            Top             =   2880
            Width           =   1095
         End
         Begin VB.OptionButton Option1 
            BackColor       =   &H00E0E0E0&
            Caption         =   "Withdrawal"
            Height          =   255
            Left            =   1800
            TabIndex        =   68
            Top             =   2520
            Width           =   1335
         End
         Begin VB.CommandButton Command3 
            BackColor       =   &H00FFFF80&
            Caption         =   "Submit"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   495
            Left            =   1680
            Style           =   1  'Graphical
            TabIndex        =   13
            Top             =   3360
            Width           =   1575
         End
         Begin VB.TextBox Text5 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   3
            TabIndex        =   12
            Top             =   1440
            Width           =   1575
         End
         Begin VB.TextBox Text4 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   6
            TabIndex        =   11
            Top             =   960
            Width           =   1575
         End
         Begin VB.TextBox Text3 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   10
            TabIndex        =   10
            Top             =   480
            Width           =   1575
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Agent Number"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   16
            Left            =   120
            TabIndex        =   71
            Top             =   1920
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Customer Country Code"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   3
            Left            =   120
            TabIndex        =   9
            Top             =   1440
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "ATM Auth Code"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   2
            Left            =   120
            TabIndex        =   8
            Top             =   960
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Customer Mobile Nr."
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   1
            Left            =   120
            TabIndex        =   7
            Top             =   480
            Width           =   1455
         End
      End
      Begin VB.TextBox Text1 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   2100
         TabIndex        =   5
         Text            =   "0"
         Top             =   360
         Width           =   1815
      End
      Begin VB.Frame Frame4 
         BackColor       =   &H00E0E0E0&
         Caption         =   "Eval Change Registration"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C000C0&
         Height          =   3975
         Left            =   4920
         TabIndex        =   32
         Top             =   600
         Visible         =   0   'False
         Width           =   4095
         Begin VB.TextBox Text17 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            TabIndex        =   45
            Top             =   2880
            Width           =   1575
         End
         Begin VB.TextBox Text16 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            TabIndex        =   44
            Top             =   2400
            Width           =   1575
         End
         Begin VB.TextBox Text15 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            TabIndex        =   43
            Top             =   1920
            Width           =   1575
         End
         Begin VB.TextBox Text14 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   10
            TabIndex        =   36
            Top             =   480
            Width           =   1575
         End
         Begin VB.TextBox Text11 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   9
            TabIndex        =   35
            Top             =   960
            Width           =   1575
         End
         Begin VB.TextBox Text10 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            TabIndex        =   34
            Top             =   1440
            Width           =   1575
         End
         Begin VB.CommandButton Command9 
            BackColor       =   &H00FFFF80&
            Caption         =   "Submit"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   495
            Left            =   1680
            Style           =   1  'Graphical
            TabIndex        =   33
            Top             =   3360
            Width           =   1575
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Birth Date"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   11
            Left            =   120
            TabIndex        =   42
            Top             =   2880
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Surname"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   10
            Left            =   120
            TabIndex        =   41
            Top             =   2400
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Middle Name"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   9
            Left            =   120
            TabIndex        =   40
            Top             =   1920
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Mobile Number"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   8
            Left            =   120
            TabIndex        =   39
            Top             =   480
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "National ID"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   7
            Left            =   120
            TabIndex        =   38
            Top             =   960
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "First Name"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   4
            Left            =   120
            TabIndex        =   37
            Top             =   1440
            Width           =   1455
         End
      End
      Begin VB.Frame Frame5 
         BackColor       =   &H00E0E0E0&
         Caption         =   "Customer Request"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C000C0&
         Height          =   3975
         Left            =   4440
         TabIndex        =   26
         Top             =   480
         Width           =   4095
         Begin VB.TextBox Text26 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            IMEMode         =   3  'DISABLE
            Left            =   1680
            MaxLength       =   6
            TabIndex        =   76
            Top             =   1440
            Width           =   1575
         End
         Begin VB.TextBox Text13 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            Left            =   1680
            MaxLength       =   10
            TabIndex        =   29
            Top             =   480
            Width           =   1575
         End
         Begin VB.TextBox Text12 
            BackColor       =   &H00C0FFFF&
            Height          =   375
            IMEMode         =   3  'DISABLE
            Left            =   1680
            MaxLength       =   6
            PasswordChar    =   "*"
            TabIndex        =   28
            Top             =   960
            Width           =   1575
         End
         Begin VB.CommandButton Command8 
            BackColor       =   &H00FFFF80&
            Caption         =   "Submit"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   495
            Left            =   1680
            Style           =   1  'Graphical
            TabIndex        =   27
            Top             =   3360
            Width           =   1575
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Loan Amount"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   17
            Left            =   120
            TabIndex        =   77
            Top             =   1440
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Mobile Number"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   6
            Left            =   120
            TabIndex        =   31
            Top             =   480
            Width           =   1455
         End
         Begin VB.Label Label4 
            Appearance      =   0  'Flat
            BackColor       =   &H00FFC0C0&
            BorderStyle     =   1  'Fixed Single
            Caption         =   "Pin Code"
            ForeColor       =   &H80000008&
            Height          =   375
            Index           =   5
            Left            =   120
            TabIndex        =   30
            Top             =   960
            Width           =   1455
         End
      End
      Begin VB.Image Image2 
         Height          =   2400
         Left            =   1800
         Picture         =   "Form1.frx":6EEC
         Top             =   1560
         Width           =   2400
      End
      Begin VB.Label Label9 
         Appearance      =   0  'Flat
         BackColor       =   &H0080FFFF&
         ForeColor       =   &H80000008&
         Height          =   195
         Left            =   2580
         TabIndex        =   48
         Top             =   2000
         Width           =   855
      End
      Begin VB.Label Label3 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         ForeColor       =   &H80000008&
         Height          =   4335
         Left            =   4320
         TabIndex        =   46
         Top             =   360
         Width           =   4575
      End
      Begin VB.Image Image1 
         Height          =   2010
         Left            =   50
         Picture         =   "Form1.frx":7BA0
         Top             =   1680
         Width           =   2010
      End
      Begin VB.Label Label4 
         Appearance      =   0  'Flat
         BackColor       =   &H00FFC0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Transaction Amount"
         ForeColor       =   &H80000008&
         Height          =   375
         Index           =   0
         Left            =   120
         TabIndex        =   4
         Top             =   360
         Width           =   1935
      End
   End
   Begin VB.CommandButton Command2 
      BackColor       =   &H00C0FFC0&
      Caption         =   "Clear"
      Height          =   495
      Left            =   7560
      Style           =   1  'Graphical
      TabIndex        =   2
      Top             =   7080
      Width           =   1095
   End
   Begin VB.TextBox Text2 
      BackColor       =   &H00FFFFFF&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00C00000&
      Height          =   1215
      Left            =   240
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   0
      Top             =   7680
      Width           =   9135
   End
   Begin VB.Timer ConnectionTimer 
      Interval        =   5000
      Left            =   720
      Top             =   0
   End
   Begin VB.Timer Timer1 
      Interval        =   2000
      Left            =   1080
      Top             =   0
   End
   Begin VB.Label Label7 
      BackStyle       =   0  'Transparent
      Caption         =   "Response Count"
      Height          =   375
      Left            =   3960
      TabIndex        =   75
      Top             =   7320
      Width           =   1215
   End
   Begin VB.Line Line2 
      X1              =   240
      X2              =   240
      Y1              =   1440
      Y2              =   1920
   End
   Begin VB.Label Label11 
      Appearance      =   0  'Flat
      BackColor       =   &H00E0E0E0&
      BorderStyle     =   1  'Fixed Single
      Caption         =   ":::::Connection status::::::"
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   240
      TabIndex        =   50
      Top             =   1690
      Width           =   1815
   End
   Begin VB.Line Line1 
      X1              =   240
      X2              =   3120
      Y1              =   1680
      Y2              =   1680
   End
   Begin VB.Label Label10 
      Appearance      =   0  'Flat
      BackColor       =   &H0080FF80&
      BorderStyle     =   1  'Fixed Single
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   2040
      TabIndex        =   49
      Top             =   1690
      Visible         =   0   'False
      Width           =   2895
   End
   Begin VB.Label Label8 
      BackStyle       =   0  'Transparent
      Caption         =   "POS"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FF00FF&
      Height          =   615
      Left            =   6840
      TabIndex        =   47
      Top             =   360
      Width           =   1095
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FEC0FF&
      FillStyle       =   0  'Solid
      Height          =   975
      Index           =   24
      Left            =   7440
      Top             =   120
      Width           =   495
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00C0FFFF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   23
      Left            =   6360
      Top             =   240
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFC0FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   22
      Left            =   3120
      Top             =   240
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFC0FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   21
      Left            =   2880
      Top             =   0
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFFFC0&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   20
      Left            =   2160
      Top             =   120
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FF80FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   19
      Left            =   5160
      Top             =   360
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00C0FFC0&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   18
      Left            =   2640
      Top             =   120
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00C0FFC0&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   17
      Left            =   3600
      Top             =   0
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFC0FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   16
      Left            =   3840
      Top             =   240
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FF80FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   15
      Left            =   1800
      Top             =   120
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FF80FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   14
      Left            =   4320
      Top             =   360
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFC0FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   13
      Left            =   4440
      Top             =   0
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00C0FFFF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   12
      Left            =   4080
      Top             =   120
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFFFC0&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   11
      Left            =   5160
      Top             =   720
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FF00FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   10
      Left            =   5400
      Top             =   240
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H0080FF80&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   9
      Left            =   4680
      Top             =   480
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFFFC0&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   8
      Left            =   4680
      Top             =   120
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFC0FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   7
      Left            =   5040
      Top             =   120
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFFFC0&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   6
      Left            =   5520
      Top             =   600
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFFFC0&
      FillStyle       =   0  'Solid
      Height          =   975
      Index           =   5
      Left            =   6720
      Top             =   120
      Width           =   135
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFFFC0&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   4
      Left            =   5400
      Top             =   0
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00C0FFC0&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   3
      Left            =   6000
      Top             =   0
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FEC0FF&
      FillStyle       =   0  'Solid
      Height          =   975
      Index           =   2
      Left            =   6960
      Top             =   120
      Width           =   375
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFC0FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   1
      Left            =   6240
      Top             =   120
      Width           =   255
   End
   Begin VB.Shape Shape1 
      BorderStyle     =   0  'Transparent
      FillColor       =   &H00FFC0FF&
      FillStyle       =   0  'Solid
      Height          =   255
      Index           =   0
      Left            =   5760
      Top             =   120
      Width           =   255
   End
   Begin VB.Label Label2 
      Appearance      =   0  'Flat
      BackColor       =   &H00FFFFC0&
      BackStyle       =   0  'Transparent
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Response Information"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   13.5
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FF0000&
      Height          =   375
      Left            =   240
      TabIndex        =   1
      Top             =   7200
      Width           =   3615
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False

Private Stan As Integer
Private Ref As Integer
Private Cashback As String
Private HOST As String
Private PORT As String
Private Merchant_ID As String
Private TNTYPE As String
Private posint As Integer
Private ResCount As Integer


Private Sub Check1_Click()
If Check1.Value = vbChecked Then
Check2.Value = vbUnchecked
Else
Check2.Value = vbChecked
End If

End Sub

Private Sub Check2_Click()
If Check2.Value = vbChecked Then
Check1.Value = vbUnchecked
Else
Check1.Value = vbChecked
End If
End Sub

Private Sub Command1_Click()

Merchant_ID = Text6.Text
If Trim(Text7.Text) <> "" And Trim(Text8.Text) <> "" Then
HOST = Trim(Text7.Text)
PORT = Trim(Text8.Text)
Winsock1.Close
Winsock1.Connect HOST, PORT
Else
MsgBox "New Settings not applied. Either IP or Port is null", vbInformation, "Uplink Connection"
End If
Frame3.Visible = True

End Sub


Private Sub Command10_Click()
Dim Msisdn As String
Dim Msisdn2 As String
Dim AuthCode As String
Dim Amount As String
Dim CHANGE As String
Dim Message As String
Text2.Text = ""
 
 If Trim(Text22.Text) = "" Or Len(Trim(Text23.Text)) <> 3 Or Len(Trim(Text24.Text)) <> 3 Then
  MsgBox "INVALID TRANSACTION SOURCE DATA", vbCritical, "Payserv Merchant"
  Exit Sub
 End If
 
 
  If Trim(Text21.Text) = "" Then
  MsgBox "INVALID RECEIVING COUNTRY CODE", vbCritical, "Payserv Merchant"
  Exit Sub
 End If
 
If IsNumeric(Trim(Text20.Text)) Then
     
            If Len(Trim(Text20.Text)) = 10 Then Msisdn = Trim(Text23.Text) & Right(Trim(Text20.Text), 9)
            If Len(Trim(Text20.Text)) = 12 Then Msisdn = Trim(Text20.Text)
     
    
'     MsgBox "INVALID TRANSACTION ORIGINATOR MOBILE NUMBER", vbCritical, "Payserv Merchant"
'     Exit Sub
'     End If
 Else
    MsgBox "INVALID TRANSACTION ORIGINATOR MOBILE NUMBER", vbCritical, "Payserv Merchant"
     Exit Sub
 End If
 
 
 
 If IsNumeric(Trim(Text19.Text)) Then
     'If Len(Trim(Text19.Text)) < 10 Or Len(Trim(Text19.Text)) > 12 Then
     If Len(Trim(Text19.Text)) = 10 Then Msisdn2 = Trim(Text21.Text) & Right(Trim(Text19.Text), 9)
     If Len(Trim(Text19.Text)) = 12 Then Msisdn2 = Trim(Text19.Text)
     
'     Else
'     MsgBox "INVALID TRANSACTION RECEPIENT MOBILE NUMBER", vbCritical, "Payserv Merchant"
'     Exit Sub
'     End If
 Else
    MsgBox "INVALID TRANSACTION RECEPIENT MOBILE NUMBER", vbCritical, "Payserv Merchant"
     Exit Sub
 End If
 
 
 If IsNumeric(Text18.Text) Then
     If InStr(1, Trim(Text18.Text), ".", vbTextCompare) > 0 Then
     Amount = Format(Mid(Trim(Text18.Text), 1, InStr(1, Trim(Text18.Text), ".", vbTextCompare)), "0000000000")
     Amount = Amount & Format(Mid(Trim(Text18.Text), InStr(1, Trim(Text18.Text), ".", vbTextCompare) + 1, Len(Trim(Text18.Text)) - InStr(1, Trim(Text18.Text), ".", vbTextCompare)), "00")
     Else
     Amount = Format(Trim(Text18.Text), "0000000000") & "00"
     End If
  Else
     MsgBox "INVALID AMOUNT", vbCritical, "Payserv Merchant"
     GoTo Do_Nothing
  End If
 
SubmitTxn:
    
    'Call Fund_Tranx_Message_ToSwitch(Msisdn, AuthCode, Amount, Message, TNTYPE, CHANGE, Cashback)
    
    Dim PostMsg As New PostBridgeISO8583
    Dim Trace As String
    Trace = ""
    'On Error GoTo ErrorTrap
    'Set PostMsg = New S1BridgeISO8583.PostBridgeISO8583
    
    Stan = Stan + 1
    Ref = Ref + 1
    With PostMsg
        .ResetBitMaps
        
        .MessageTypeID = "0200"
          Trace = "Message type: " & .MessageTypeID & vbNewLine
          
        
         .Pan = Msisdn: .CreatePBBitMap (2): Trace = Trace & "Field 002: " & .Pan & vbNewLine
         .ProcessingCODE = "420000": .CreatePBBitMap (3): Trace = Trace & "Field 003: " & .ProcessingCODE & vbNewLine
         .AmtTransaction = Amount: .CreatePBBitMap (4): Trace = Trace & "Field 004: " & .AmtTransaction & vbNewLine
         .DatetimeTransmission = Format(Month(Date), "00") & Format(Day(Date), "00") & Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (7): Trace = Trace & "Field 007: " & .DatetimeTransmission & vbNewLine
         .SysTraceAuditNum = Format(Stan, "000000"): .CreatePBBitMap (11): Trace = Trace & "Field 011: " & .SysTraceAuditNum & vbNewLine
         .TimeLocTxn = Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (12): Trace = Trace & "Field 012: " & .DateLocTxn & vbNewLine
         .DateLocTxn = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (13): Trace = Trace & "Field 013: " & .TimeLocTxn & vbNewLine
         .DateExpiry = "2012": .CreatePBBitMap (14): Trace = Trace & "Field 014: " & .DateExpiry & vbNewLine
         .DateSettle = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (15): Trace = Trace & "Field 015: " & .DateSettle & vbNewLine
         .MerchantType = "6010": .CreatePBBitMap (18): Trace = Trace & "Field 018: " & .MerchantType & vbNewLine
         .POSEntryMode = "012": .CreatePBBitMap (22): Trace = Trace & "Field 022: " & .POSEntryMode & vbNewLine
         .POSConditionCode = "00": .CreatePBBitMap (25): Trace = Trace & "Field 025: " & .POSConditionCode & vbNewLine
         .POSPinCaptureCode = "04": .CreatePBBitMap (26): Trace = Trace & "Field 026: " & .POSPinCaptureCode & vbNewLine
         .AmtTxnFee = "D00001000": .CreatePBBitMap (28): Trace = Trace & "Field 028: " & .AmtTxnFee & vbNewLine
         .AmtTxnProcessingFee = "D00000000": .CreatePBBitMap (30): Trace = Trace & "Field 030: " & .AmtTxnProcessingFee & vbNewLine
         .AcquiringInstIdCode = Trim(Text23.Text): .CreatePBBitMap (32): Trace = Trace & "Field 032: " & .AcquiringInstIdCode & vbNewLine
         .ForwardingInstIdCode = "254": .CreatePBBitMap (33): Trace = Trace & "Field 033: " & .ForwardingInstIdCode & vbNewLine
         .RetrievalRefNum = Format(Ref, "000000000000"): .CreatePBBitMap (37): Trace = Trace & "Field 037: " & .RetrievalRefNum & vbNewLine
         '.AuthIdResp = "": .CreatePBBitMap (38): Trace = Trace & "Field 038: " & .AuthIdResp & vbNewLine
         '.RespCode = "" : .CreatePBBitMap (39): Trace = Trace & "Field 039: " & .RespCode & vbNewLine
         '.ServiceRestrictionCode = "" : .CreatePBBitMap (40): Trace = Trace & "Field 040: " & .ServiceRestrictionCode & vbNewLine
         .CardAcceptorTermId = "10102345": .CreatePBBitMap (41): Trace = Trace & "Field 041: " & .CardAcceptorTermId & vbNewLine
         If Len(Merchant_ID) < 15 Then
          .CardAcceptorIdCode = "123456789012347"
          Else
          .CardAcceptorIdCode = Merchant_ID
          End If
          .CreatePBBitMap (42): Trace = Trace & "Field 042: " & .CardAcceptorIdCode & vbNewLine
         
         .CardAcceptorNameLoc = Trim(Text22.Text) & Space(40 - Len(Trim(Text22.Text))): .CreatePBBitMap (43): Trace = Trace & "Field 043: " & .CardAcceptorNameLoc & vbNewLine
        ' .AdditionalRespData <> "" : .CreatePBBitMap (44):: Trace = Trace & "Field 044: " & .AdditionalRespData & vbNewLine
         '.AdditionalData = AuthCode: .CreatePBBitMap (48): Trace = Trace & "Field 048: " & .AdditionalData & vbNewLine
         .CurrencyCodeTxn = Trim(Text24.Text): .CreatePBBitMap (49): Trace = Trace & "Field 049: " & .CurrencyCodeTxn & vbNewLine
         .EchoData = Format(Ref, "000000000000"): .CreatePBBitMap (59): Trace = Trace & "Field 059: " & .EchoData & vbNewLine
         .ReceivingInstIdCode = Trim(Text21.Text): .CreatePBBitMap (100): Trace = Trace & "Field 100: " & .ReceivingInstIdCode & vbNewLine
         .AccIdOne = Msisdn: .CreatePBBitMap (102): Trace = Trace & "Field 102: " & .AccIdOne & vbNewLine
         .AccIdTwo = Msisdn2: .CreatePBBitMap (103): Trace = Trace & "Field 103: " & .AccIdTwo & vbNewLine
        ' .POSDataCode = "" : .CreatePBBitMap (123): Trace = Trace & "Field 123: " & .POSDataCode & vbNewLine
        
         
        'Create new message
        strNewMessage = .CREATEMsgISO8538
        End With
    
    If strNewMessage <> "" Then SendMessageToTest strNewMessage
    
    'Frame2.Enabled = False
ErrorTrap:
 
Do_Nothing:
End Sub

Private Sub Command11_Click()

Frame6.Visible = True
Frame2.Visible = False
'Frame6.Caption = "Fund Transfer"
Frame4.Visible = False
Label4(3).Visible = True
Text5.Visible = True
Frame5.Visible = False
TNTYPE = "52"

End Sub

Private Sub Command12_Click()

End Sub

'Private Sub Command10_Click()
'Dim Xaxis As Integer
'Dim Yaxis As Integer
'Dim I As Integer
'
'For I = 3 To 20
'  Load Shape1(I)
'  Shape1(I).Top = Shape1(I - 1).Top + Shape1(I - 1).Height
'  Shape1(I).Left = Shape1(I - 1).Left + Shape1(I - 1).Width
'  Shape1(I).Visible = True
'  If I Mod 2 = 0 Then
'    Shape1(I).FillColor = &HFFC0FE
'  Else
'    Shape1(I).FillColor = &HFFFFE0
'  End If
'
'Next I
'
'
'End Sub

Private Sub Command2_Click()
Text2.Text = ""
'Text2.Enabled = False
'Frame2.Visible = False
Text9.Text = ""
ResCount = 0
End Sub

Private Sub Command3_Click()
Dim Msisdn As String
Dim AuthCode As String
Dim Amount As String
Dim CHANGE As String
Dim Message As String

Text2.Text = ""


If Trim(Text22.Text) = "" Or Len(Trim(Text23.Text)) <> 3 Or Len(Trim(Text24.Text)) <> 3 Then
  MsgBox "INVALID TRANSACTION SOURCE DATA", vbCritical, "Payserv Merchant"
  Exit Sub
 End If
 
 
If IsNumeric(Trim(Text3.Text)) Then
     
            If Len(Trim(Text3.Text)) = 10 Then Msisdn = Trim(Text5.Text) & Right(Trim(Text3.Text), 9)
            If Len(Trim(Text3.Text)) = 12 Then Msisdn = Trim(Text3.Text)
     
    
'     MsgBox "INVALID TRANSACTION ORIGINATOR MOBILE NUMBER", vbCritical, "Payserv Merchant"
'     Exit Sub
'     End If
 Else
    MsgBox "INVALID TRANSACTION ORIGINATOR MOBILE NUMBER", vbCritical, "Payserv Merchant"
     Exit Sub
 End If
 
Dim AgentATM As String

If Option1.Value = True And Check2.Value = 1 Then 'ATM
 If Len(Trim(Text25.Text)) > 1 Then
       AuthCode = Trim(Text25.Text)
       AgentATM = "AGENT"
        Else
            MsgBox "INVALID AGENT NUMBER", vbCritical, "Payserv Merchant"
            GoTo Do_Nothing
        End If
 
 ElseIf Option1.Value = True And Check1.Value = 1 Then
  
    
    If Len(Trim(Text25.Text)) > 1 Then
       AuthCode = Trim(Text25.Text)
       AgentATM = "AGENT"
        Else
            MsgBox "INVALID AGENT NUMBER", vbCritical, "Payserv Merchant"
            GoTo Do_Nothing
        End If
        
 End If
 
 If Trim(Text5.Text) = "" Then
  MsgBox "INVALID RECEIVING COUNTRY CODE", vbCritical, "Payserv Merchant"
            GoTo Do_Nothing
 End If
 
 
 
 
 
 If IsNumeric(Text1.Text) Then
     If InStr(1, Trim(Text1.Text), ".", vbTextCompare) > 0 Then
     Amount = Format(Mid(Trim(Text1.Text), 1, InStr(1, Trim(Text1.Text), ".", vbTextCompare)), "0000000000")
     Amount = Amount & Format(Mid(Trim(Text1.Text), InStr(1, Trim(Text1.Text), ".", vbTextCompare) + 1, Len(Trim(Text1.Text)) - InStr(1, Trim(Text1.Text), ".", vbTextCompare)), "00")
     Else
     Amount = Format(Trim(Text1.Text), "0000000000") & "00"
     End If
  Else
     MsgBox "INVALID AMOUNT", vbCritical, "Payserv Merchant"
     GoTo Do_Nothing
  End If
 
' If IsNumeric(Text9.Text) Then
'     If InStr(1, Trim(Text9.Text), ".", vbTextCompare) > 0 Then
'     CHANGE = Format(Mid(Trim(Text9.Text), 1, InStr(1, Trim(Text9.Text), ".", vbTextCompare)), "0000000000")
'     CHANGE = Amount & Format(Mid(Trim(Text9.Text), InStr(1, Trim(Text9.Text), ".", vbTextCompare) + 1, Len(Trim(Text9.Text)) - InStr(1, Trim(Text9.Text), ".", vbTextCompare)), "00")
'     Else
'     CHANGE = Format(Trim(Text9.Text), "0000000000") & "00"
'     End If
'  Else
'     MsgBox "INVALID CHANGE AMOUNT", vbCritical, "Payserv Merchant"
'     GoTo Do_Nothing
'  End If
'
' If Len(Trim(Text5.Text)) > 0 Then
'    If IsNumeric(Trim(Text5.Text)) Then
'     Cashback = Format(Trim(Text5.Text), "000000000000")
'     Else
'     MsgBox "INVALID AMOUNT CASH BACK", vbCritical, "Payserv Merchant"
'     GoTo Do_Nothing
'    End If
' Else
'     Cashback = ""
' End If
 
 
SubmitTxn:
    
    Dim PostMsg As New PostBridgeISO8583
    Dim Trace As String
    Trace = ""
    'On Error GoTo ErrorTrap
    'Set PostMsg = New S1BridgeISO8583.PostBridgeISO8583
    
    Stan = Stan + 1
    Ref = Ref + 1
    With PostMsg
        .ResetBitMaps
        
        .MessageTypeID = "0200"
          Trace = "Message type: " & .MessageTypeID & vbNewLine
          
         
         .Pan = Msisdn: .CreatePBBitMap (2): Trace = Trace & "Field 002: " & .Pan & vbNewLine
         If Option1.Value = True Then
         .ProcessingCODE = "010000": .CreatePBBitMap (3): Trace = Trace & "Field 003: " & .ProcessingCODE & vbNewLine
         ElseIf Option2.Value = True Then
          .ProcessingCODE = "210000": .CreatePBBitMap (3): Trace = Trace & "Field 003: " & .ProcessingCODE & vbNewLine
         End If
         .AmtTransaction = Amount: .CreatePBBitMap (4): Trace = Trace & "Field 004: " & .AmtTransaction & vbNewLine
         .DatetimeTransmission = Format(Month(Date), "00") & Format(Day(Date), "00") & Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (7): Trace = Trace & "Field 007: " & .DatetimeTransmission & vbNewLine
         .SysTraceAuditNum = Format(Stan, "000000"): .CreatePBBitMap (11): Trace = Trace & "Field 011: " & .SysTraceAuditNum & vbNewLine
         .TimeLocTxn = Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (12): Trace = Trace & "Field 012: " & .DateLocTxn & vbNewLine
         .DateLocTxn = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (13): Trace = Trace & "Field 013: " & .TimeLocTxn & vbNewLine
         .DateExpiry = "2012": .CreatePBBitMap (14): Trace = Trace & "Field 014: " & .DateExpiry & vbNewLine
         .DateSettle = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (15): Trace = Trace & "Field 015: " & .DateSettle & vbNewLine
         .MerchantType = "6010": .CreatePBBitMap (18): Trace = Trace & "Field 018: " & .MerchantType & vbNewLine
         .POSEntryMode = "012": .CreatePBBitMap (22): Trace = Trace & "Field 022: " & .POSEntryMode & vbNewLine
         .POSConditionCode = "00": .CreatePBBitMap (25): Trace = Trace & "Field 025: " & .POSConditionCode & vbNewLine
         .POSPinCaptureCode = "04": .CreatePBBitMap (26): Trace = Trace & "Field 026: " & .POSPinCaptureCode & vbNewLine
         .AmtTxnFee = "D00001000": .CreatePBBitMap (28): Trace = Trace & "Field 028: " & .AmtTxnFee & vbNewLine
         .AmtTxnProcessingFee = "D00000000": .CreatePBBitMap (30): Trace = Trace & "Field 030: " & .AmtTxnProcessingFee & vbNewLine
         .AcquiringInstIdCode = Trim(Text23.Text): .CreatePBBitMap (32): Trace = Trace & "Field 032: " & .AcquiringInstIdCode & vbNewLine
         .ForwardingInstIdCode = "254": .CreatePBBitMap (33): Trace = Trace & "Field 033: " & .ForwardingInstIdCode & vbNewLine
         .RetrievalRefNum = Format(Ref, "000000000000"): .CreatePBBitMap (37): Trace = Trace & "Field 037: " & .RetrievalRefNum & vbNewLine
         If AgentATM = "ATM" Then
         .AuthIdResp = AuthCode: .CreatePBBitMap (38): Trace = Trace & "Field 038: " & .AuthIdResp & vbNewLine
         End If
         .CardAcceptorTermId = "10102345": .CreatePBBitMap (41): Trace = Trace & "Field 041: " & .CardAcceptorTermId & vbNewLine
         If Len(Merchant_ID) < 15 Then
          .CardAcceptorIdCode = "123456789012347"
          Else
          .CardAcceptorIdCode = Merchant_ID
          End If
          .CreatePBBitMap (42): Trace = Trace & "Field 042: " & .CardAcceptorIdCode & vbNewLine
         .CardAcceptorNameLoc = Trim(Text22.Text) & Space(40 - Len(Trim(Text22.Text))): .CreatePBBitMap (43): Trace = Trace & "Field 043: " & .CardAcceptorNameLoc & vbNewLine
        
         .AdditionalData = AuthCode: .CreatePBBitMap (48): Trace = Trace & "Field 048: " & .AdditionalData & vbNewLine
         .AdditionalRespData = AgentATM: .CreatePBBitMap (44)
         .CurrencyCodeTxn = Trim(Text24.Text): .CreatePBBitMap (49): Trace = Trace & "Field 049: " & .CurrencyCodeTxn & vbNewLine
         .EchoData = Format(Ref, "000000000000"): .CreatePBBitMap (59): Trace = Trace & "Field 059: " & .EchoData & vbNewLine
         .AccIdOne = Msisdn: .CreatePBBitMap (102): Trace = Trace & "Field 102: " & .AccIdOne & vbNewLine
         
          If .PinData <> "" Then .CreatePBBitMap (52)
          .ReceivingInstIdCode = Trim(Text5.Text): .CreatePBBitMap (100)
          If AgentATM = "AGENT" Then
              .AccIdTwo = AuthCode: .CreatePBBitMap (103): Trace = Trace & "Field 103: " & .AccIdTwo & vbNewLine
          End If
        
         
        'Create new message
        strNewMessage = .CREATEMsgISO8538
        End With
    
    If strNewMessage <> "" Then SendMessageToTest strNewMessage
       
 
Do_Nothing:
    
      

End Sub

Private Sub Command4_Click()
Frame2.Visible = True
Frame2.Caption = "Agent Cash Withdraw/Deposit"
Frame4.Visible = False
Label4(3).Visible = True
Text5.Visible = True
Frame5.Visible = False
TNTYPE = "00"
Frame6.Visible = False
End Sub

Private Sub Command5_Click()
Frame2.Visible = False
Frame5.Visible = False
Frame4.Visible = True
Frame6.Visible = False
End Sub

Private Sub Command6_Click()
Frame2.Visible = True
Frame5.Visible = False
Text3.Text = Text13.Text
Frame4.Visible = False
Label4(3).Visible = False
Text5.Visible = False
Frame2.Caption = "Change Top Up"
TNTYPE = "21"
Frame6.Visible = False
End Sub

Private Sub Command7_Click()
Frame5.Visible = True
Frame2.Visible = False
Frame4.Visible = False
Frame6.Visible = False
End Sub

Private Sub Command8_Click()
Dim Msisdn As Variant
Dim AuthCode As Variant
Dim Message As String
Dim Amount As Variant
On Error GoTo ErrTrap
Msisdn = Trim(Text13.Text)
AuthCode = Trim(Text12.Text)
Amount = Trim(Text26.Text)
If Msisdn = "" Or Len(Msisdn) <> 10 Then
MsgBox "INVALID PHONE NUMBER ENTERED", vbCritical, "Payserv Merchant"
Exit Sub
End If

If Len(AuthCode) < 4 Then
MsgBox "INVALID PIN CODE", vbCritical, "Payserv Merchant"
Exit Sub
End If

If IsNumeric(Amount) = False Then
MsgBox "INVALID AMOUNT", vbCritical, "Payserv Merchant"
Exit Sub
End If
  Call Message_PINVerifyToSwitch(Msisdn, AuthCode, Amount, Message, Cashback)
    
    If Message <> "" Then SendMessageToTest Message
    
Exit Sub
ErrTrap:
MsgBox "ERROR OCCURED", vbCritical, "Payserv Merchant"

End Sub

Private Sub Command9_Click()

Dim Msisdn As Variant
Dim FName As Variant
Dim MName As Variant
Dim surName As Variant
Dim Nat_ID As Variant
Dim BirthDate As Variant

Msisdn = Trim(Text14.Text)
Nat_ID = Trim(Text11.Text)
FName = Trim(Text10.Text)
MName = Trim(Text15.Text)
surName = Trim(Text16.Text)
BirthDate = Trim(Text17.Text)

Dim Message As String


  Call Message_RegToSwitch(Msisdn, Message, FName, MName, surName, Nat_ID, BirthDate)
    
    If Message <> "" Then SendMessageToTest Message


End Sub

Private Sub Form_Load()

Stan = 1
Ref = 1

HOST = "127.0.0.1"
PORT = "4545"
Merchant_ID = "639485000000501"

If Winsock1.State <> sckConnected Then
Winsock1.Close
Winsock1.Connect HOST, PORT

'Winsock1.SendData ("00000000000000000000000000000000000")
    Else
    End If
    DoEvents
Frame1.BackColor = &HFFFFE0


Option1.Value = True
Check1.Value = 1
End Sub

Private Sub ConnectionTimer_Timer()
           If Winsock1.State <> sckConnected Then
            
            Winsock1.Close
            Winsock1.Connect HOST, PORT
            Label10.Caption = "| | | NO CONNECTION TO HOST >>>"
            Label10.BackColor = &HFF&
         Else
           
            Label10.BackColor = &H80FF80
            Label10.Caption = "| | | CONNECTED TO HOST >>>>"
         'MessageTxt.Text = "Mobile Server connected"
         
        End If
        
  
    
    DoEvents

End Sub

Private Sub Login_Click()
'frmLogin.Show
End Sub

Private Sub Seto_Click()
Frame3.Visible = True
End Sub

Private Sub Text4_LostFocus()
Text4.Text = UCase(Text4.Text)
End Sub

Private Sub Timer1_Timer()
posint = posint + 1
If posint Mod 2 = 0 Then
Label9.BackColor = &HC0FFC0
'Label10.Visible = True
Else
Label9.BackColor = &H80FFFF
'Label10.Visible = False
End If

If posint > 3 Then Timer2.Enabled = False: Label10.Visible = True
If posint > 20 Then posint = 0: Timer2.Enabled = True

End Sub

Private Sub Timer2_Timer()
If Label10.Visible = True Then
Label10.Visible = False
Else
Label10.Visible = True
End If
End Sub

Private Sub Winsock1_Close()
    Winsock1.Close
   
End Sub

Private Sub Winsock1_Connect()
   If Winsock1.State = sckConnected Then
   
   'Text1.Text = "Connected"
        ''
    End If
    
End Sub

Public Sub SendMessageToTest(ByVal PMessage As String)
    If Winsock1.State = sckConnected Then
        Winsock1.SendData PMessage
    
    Else
    'Text2.Enabled = true
    Text2.Text = "Not connected"
    End If
End Sub

Private Sub Winsock1_DataArrival(ByVal bytesTotal As Long)
Dim Response As String
Dim RSP_CODE As String
Dim TranType As String
Dim StrMessageTOProcess As String
Dim intStreamLen As Integer
Dim intMsgLength As Integer
If Winsock1.State = sckConnected Then
        Winsock1.GetData Response
        
        
        
        Do While Response <> ""
                     
                     intStreamLen = Len(Response)
                     intMsgLength = Mid(Response, 1, 4) + 4        ' get message length
                     
                     StrMessageTOProcess = Mid(Response, 1, intMsgLength)    ' get message from stream
                      Call Switch_Message_Processor(Response, TranType, RSP_CODE)
                     Response = Mid(Response, intMsgLength + 1, intStreamLen - intMsgLength)  ' return rest of the stream
                    
                                  
            
        
'           Text2.Text = "RESPONSE FROM HOST: " & vbNewLine
'           Text2.Text = Text2.Text & "AMOUNT : " & Text18.Text & vbNewLine & "RESPONSE :"
'           If RSP_CODE = "00" Then
'            Text2.Text = Text2.Text & "TRANSACTION APPROVED...."
'           Else
'           Text2.Text = Text2.Text & "TRANSACTION DECLINED...." & "CODE: " & RSP_CODE
'           End If
'           ResCount = ResCount + 1
'           Text9.Text = ResCount
        Loop
        End If
End Sub

Private Sub Switch_Message_Processor(ByVal Message As String, ByRef Tran_Type As String, ByRef RSPCODE As String)
    
    Dim PostMsg As PostBridgeISO8583
    Dim strNewMessage As String
    Dim AuthRespCode As String
    Dim Index As Integer
'    Dim Recset As New ADODB.Recordset
    Trace = ""
    On Error GoTo ErrorTrap
    Set PostMsg = New PostBridgeISO8583
    
    
    With PostMsg
        .ISO8583MsgBD Message
        .ResetBitMaps
        '.MessageTypeID = "0200"
        
        Trace = "Message type: " & .MessageTypeID & vbNewLine
        
        
        
        If .Pan <> "" Then .CreatePBBitMap (2): Trace = Trace & "Field 002: " & .Pan & vbNewLine
        If .ProcessingCODE <> "" Then .CreatePBBitMap (3): Trace = Trace & "Field 003: " & .ProcessingCODE & vbNewLine
        If .AmtTransaction <> "" Then .CreatePBBitMap (4): Trace = Trace & "Field 004: " & .AmtTransaction & vbNewLine
        If .DatetimeTransmission <> "" Then .CreatePBBitMap (7): Trace = Trace & "Field 007: " & .DatetimeTransmission & vbNewLine
        If .SysTraceAuditNum <> "" Then .CreatePBBitMap (11): Trace = Trace & "Field 011: " & .SysTraceAuditNum & vbNewLine
        If .TimeLocTxn <> "" Then .CreatePBBitMap (12): Trace = Trace & "Field 012: " & .DateLocTxn & vbNewLine
        If .DateLocTxn <> "" Then .CreatePBBitMap (13): Trace = Trace & "Field 013: " & .TimeLocTxn & vbNewLine
        If .DateExpiry <> "" Then .CreatePBBitMap (14): Trace = Trace & "Field 014: " & .DateExpiry & vbNewLine
        If .DateSettle <> "" Then .CreatePBBitMap (15): Trace = Trace & "Field 015: " & .DateSettle & vbNewLine
        If .MerchantType <> "" Then .CreatePBBitMap (18): Trace = Trace & "Field 018: " & .MerchantType & vbNewLine
        If .POSEntryMode <> "" Then .CreatePBBitMap (22): Trace = Trace & "Field 022: " & .POSEntryMode & vbNewLine
        If .CardSeqNum <> "" Then .CreatePBBitMap (23): Trace = Trace & "Field 023: " & .CardSeqNum & vbNewLine
        If .POSConditionCode <> "" Then .CreatePBBitMap (25): Trace = Trace & "Field 025: " & .POSConditionCode & vbNewLine
        If .POSPinCaptureCode <> "" Then .CreatePBBitMap (26): Trace = Trace & "Field 026: " & .POSPinCaptureCode & vbNewLine
        If .AmtTxnFee <> "" Then .CreatePBBitMap (28): Trace = Trace & "Field 028: " & .AmtTxnFee & vbNewLine
        If .AmtTxnProcessingFee <> "" Then .CreatePBBitMap (30): Trace = Trace & "Field 030: " & .AmtTxnProcessingFee & vbNewLine
        If .AcquiringInstIdCode <> "" Then .CreatePBBitMap (32): Trace = Trace & "Field 032: " & .AcquiringInstIdCode & vbNewLine
        If .ForwardingInstIdCode <> "" Then .CreatePBBitMap (33): Trace = Trace & "Field 033: " & .ForwardingInstIdCode & vbNewLine
        If .Track2Data <> "" Then .CreatePBBitMap (35): Trace = Trace & "Field 035: " & .Track2Data & vbNewLine
        If .RetrievalRefNum <> "" Then .CreatePBBitMap (37): Trace = Trace & "Field 037: " & .RetrievalRefNum & vbNewLine
        If .AuthIdResp <> "" Then .CreatePBBitMap (38): Trace = Trace & "Field 038: " & .AuthIdResp & vbNewLine
        If .RespCode <> "" Then .CreatePBBitMap (39): Trace = Trace & "Field 039: " & .RespCode & vbNewLine
        If .ServiceRestrictionCode <> "" Then .CreatePBBitMap (40): Trace = Trace & "Field 040: " & .ServiceRestrictionCode & vbNewLine
        If .CardAcceptorTermId <> "" Then .CreatePBBitMap (41): Trace = Trace & "Field 041: " & .CardAcceptorTermId & vbNewLine
        If .CardAcceptorIdCode <> "" Then .CreatePBBitMap (42): Trace = Trace & "Field 042: " & .CardAcceptorIdCode & vbNewLine
        If .CardAcceptorNameLoc <> "" Then .CreatePBBitMap (43): Trace = Trace & "Field 043: " & .CardAcceptorNameLoc & vbNewLine
        If .AdditionalRespData <> "" Then .CreatePBBitMap (44):: Trace = Trace & "Field 044: " & .AdditionalRespData & vbNewLine
        If .AdditionalData <> "" Then .CreatePBBitMap (48): Trace = Trace & "Field 048: " & .AdditionalData & vbNewLine
        If .CurrencyCodeTxn <> "" Then .CreatePBBitMap (49): Trace = Trace & "Field 049: " & .CurrencyCodeTxn & vbNewLine
        If .PinData <> "" Then .CreatePBBitMap (52): Trace = Trace & "Field 052: " & "****************" & vbNewLine
        If .AdditionalAmts <> "" Then .CreatePBBitMap (54): Trace = Trace & "Field 054: " & .AdditionalAmts & vbNewLine
        If .MsgReasonCode <> "" Then .CreatePBBitMap (56): Trace = Trace & "Field 056: " & .MsgReasonCode & vbNewLine
        If .EchoData <> "" Then .CreatePBBitMap (59): Trace = Trace & "Field 059: " & .EchoData & vbNewLine
        If .NetMangtInfoCode <> "" Then .CreatePBBitMap (70): Trace = Trace & "Field 070: " & .NetMangtInfoCode & vbNewLine
        If .OriginalDataElements <> "" Then .CreatePBBitMap (90): Trace = Trace & "Field 090: " & .OriginalDataElements & vbNewLine
        If .ReplacementAmts <> "" Then .CreatePBBitMap (95): Trace = Trace & "Field 095: " & .ReplacementAmts & vbNewLine
        If .ReceivingInstIdCode <> "" Then .CreatePBBitMap (100): Trace = Trace & "Field 100: " & .ReceivingInstIdCode & vbNewLine
        If .AccIdOne <> "" Then .CreatePBBitMap (102): Trace = Trace & "Field 102: " & .AccIdOne & vbNewLine
        If .AccIdTwo <> "" Then .CreatePBBitMap (103): Trace = Trace & "Field 103: " & .AccIdTwo & vbNewLine
        If .POSDataCode <> "" Then .CreatePBBitMap (123): Trace = Trace & "Field 123: " & .POSDataCode & vbNewLine
        
         
        'Create new message
        
        
        Tran_Type = Left(.ProcessingCODE, 2)
        RSPCODE = IIf(.RespCode = "", "92", .RespCode)
        AuthRespCode = .AuthIdResp
        
        '        If Tran_Type = "00" And Cashback <> "" And .RespCode = "00" Then
        '        strNewMessage = .CREATEMsgISO8538
        '        SendMessageToTest strNewMessage
        '        Cashback = ""
        '        End If
        
       
           Text2.Text = "RESPONSE FROM CREDITSCORE HOST " & vbNewLine
           Text2.Text = Text2.Text & "AMOUNT REQUESTED : " & Format(Val(.AmtTransaction) / 100, "#,###") & vbNewLine
           If .RespCode = "00" Then
            Text2.Text = Text2.Text & "AMOUNT APPROVED: " & Format(Val(.AmtTransaction) / 100, "#,###")
            
            If .AmtSettlement <> "" Then
              Text2.Text = Text2.Text & "  CREDIT VALUE: " & Format(Val(.AmtSettlement) / 100, "#,###")
            End If
            
            If .AmtTxnFee <> "" Then
              Text2.Text = Text2.Text & "  CREDIT SCORE: " & Val(Right(.AmtTxnFee, 8)) / 100
            End If
           
           Else
           Text2.Text = Text2.Text & "TRANSACTION DECLINED," & " REASON: " & .RespCode
           End If
           
           ResCount = ResCount + 1
           Text9.Text = ResCount
       
       
       End With
       
ErrorTrap:
       
        
End Sub


Private Sub Message_ToSwitch(ByVal Msisdn As String, ByVal AuthCode As String, ByVal GOODSAMNT As String, ByRef strNewMessage As String, ByVal TTYPE As String, Optional ChangeTopup As String, Optional ByVal Cashback As String)
    
    Dim PostMsg As New PostBridgeISO8583
    

    Dim Trace As String
    Trace = ""
    'On Error GoTo ErrorTrap
    'Set PostMsg = New S1BridgeISO8583.PostBridgeISO8583
    
    Stan = Stan + 1
    Ref = Ref + 1
    With PostMsg
        .ResetBitMaps
        
        .MessageTypeID = "0200"
          Trace = "Message type: " & .MessageTypeID & vbNewLine
        
        
         .Pan = "639485035000017280": .CreatePBBitMap (2): Trace = Trace & "Field 002: " & .Pan & vbNewLine
         If TTYPE = "00" Then
          .ProcessingCODE = "000000": .CreatePBBitMap (3): Trace = Trace & "Field 003: " & .ProcessingCODE & vbNewLine
          .AmtTransaction = GOODSAMNT: .CreatePBBitMap (4): Trace = Trace & "Field 004: " & .AmtTransaction & vbNewLine
          ElseIf TTYPE = "21" Then
          .ProcessingCODE = "210000": .CreatePBBitMap (3): Trace = Trace & "Field 003: " & .ProcessingCODE & vbNewLine
          .AmtTransaction = ChangeTopup: .CreatePBBitMap (4): Trace = Trace & "Field 004: " & .AmtTransaction & vbNewLine
         
         End If
         .DatetimeTransmission = Format(Month(Date), "00") & Format(Day(Date), "00") & Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (7): Trace = Trace & "Field 007: " & .DatetimeTransmission & vbNewLine
         .SysTraceAuditNum = Format(Stan, "000000"): .CreatePBBitMap (11): Trace = Trace & "Field 011: " & .SysTraceAuditNum & vbNewLine
         .TimeLocTxn = Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (12): Trace = Trace & "Field 012: " & .DateLocTxn & vbNewLine
         .DateLocTxn = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (13): Trace = Trace & "Field 013: " & .TimeLocTxn & vbNewLine
         .DateExpiry = "2012": .CreatePBBitMap (14): Trace = Trace & "Field 014: " & .DateExpiry & vbNewLine
         .DateSettle = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (15): Trace = Trace & "Field 015: " & .DateSettle & vbNewLine
         .MerchantType = "6010": .CreatePBBitMap (18): Trace = Trace & "Field 018: " & .MerchantType & vbNewLine
         .POSEntryMode = "012": .CreatePBBitMap (22): Trace = Trace & "Field 022: " & .POSEntryMode & vbNewLine
         .POSConditionCode = "00": .CreatePBBitMap (25): Trace = Trace & "Field 025: " & .POSConditionCode & vbNewLine
         .POSPinCaptureCode = "04": .CreatePBBitMap (26): Trace = Trace & "Field 026: " & .POSPinCaptureCode & vbNewLine
         '.AmtTxnFee = "D00000000": .CreatePBBitMap (28): Trace = Trace & "Field 028: " & .AmtTxnFee & vbNewLine
         '.AmtTxnProcessingFee = "D00000000": .CreatePBBitMap (30): Trace = Trace & "Field 030: " & .AmtTxnProcessingFee & vbNewLine
         .AcquiringInstIdCode = "625625": .CreatePBBitMap (32): Trace = Trace & "Field 032: " & .AcquiringInstIdCode & vbNewLine
         .ForwardingInstIdCode = Msisdn: .CreatePBBitMap (33): Trace = Trace & "Field 033: " & .ForwardingInstIdCode & vbNewLine
        '.Track2Data = "" : .CreatePBBitMap (35): Trace = Trace & "Field 035: " & .Track2Data & vbNewLine
         .RetrievalRefNum = Format(Ref, "000000000000"): .CreatePBBitMap (37): Trace = Trace & "Field 037: " & .RetrievalRefNum & vbNewLine
         '.AuthIdResp = "" : .CreatePBBitMap (38): Trace = Trace & "Field 038: " & .AuthIdResp & vbNewLine
         '.RespCode = "" : .CreatePBBitMap (39): Trace = Trace & "Field 039: " & .RespCode & vbNewLine
         '.ServiceRestrictionCode = "" : .CreatePBBitMap (40): Trace = Trace & "Field 040: " & .ServiceRestrictionCode & vbNewLine
         .CardAcceptorTermId = "10102345": .CreatePBBitMap (41): Trace = Trace & "Field 041: " & .CardAcceptorTermId & vbNewLine
         If Len(Merchant_ID) < 15 Then
          .CardAcceptorIdCode = "123456789012347"
          Else
          .CardAcceptorIdCode = Merchant_ID
          End If
          .CreatePBBitMap (42): Trace = Trace & "Field 042: " & .CardAcceptorIdCode & vbNewLine
         
         .CardAcceptorNameLoc = "Supermart 123           Nairobi       KE": .CreatePBBitMap (43): Trace = Trace & "Field 043: " & .CardAcceptorNameLoc & vbNewLine
         .AdditionalRespData = AuthCode: .CreatePBBitMap (44): Trace = Trace & "Field 044: " & .AdditionalRespData & vbNewLine
         .AdditionalData = AuthCode: .CreatePBBitMap (48): Trace = Trace & "Field 048: " & .AdditionalData & vbNewLine
         .CurrencyCodeTxn = "404": .CreatePBBitMap (49): Trace = Trace & "Field 049: " & .CurrencyCodeTxn & vbNewLine
        ' .PinData = "12345678": .CreatePBBitMap (52): Trace = Trace & "Field 052: " & "****************" & vbNewLine
        ' .AdditionalAmts <> "" : .CreatePBBitMap (54): Trace = Trace & "Field 054: " & .AdditionalAmts & vbNewLine
        ' .MsgReasonCode = "1506": .CreatePBBitMap (56): Trace = Trace & "Field 056: " & .MsgReasonCode & vbNewLine
         .EchoData = Format(Ref, "000000000000"): .CreatePBBitMap (59): Trace = Trace & "Field 059: " & .EchoData & vbNewLine
        ' .NetMangtInfoCode = "" : .CreatePBBitMap (70): Trace = Trace & "Field 070: " & .NetMangtInfoCode & vbNewLine
        ' .OriginalDataElements <> "" : .CreatePBBitMap (90): Trace = Trace & "Field 090: " & .OriginalDataElements & vbNewLine
        ' .ReplacementAmts <> "" : .CreatePBBitMap (95): Trace = Trace & "Field 095: " & .ReplacementAmts & vbNewLine
         .ReceivingInstIdCode = "": .CreatePBBitMap (100): Trace = Trace & "Field 100: " & .ReceivingInstIdCode & vbNewLine
         .AccIdOne = Msisdn: .CreatePBBitMap (102): Trace = Trace & "Field 102: " & .AccIdOne & vbNewLine
         .AccIdTwo = AuthCode: .CreatePBBitMap (103): Trace = Trace & "Field 103: " & .AccIdTwo & vbNewLine
        ' .POSDataCode = "" : .CreatePBBitMap (123): Trace = Trace & "Field 123: " & .POSDataCode & vbNewLine
        
         
        'Create new message
        strNewMessage = .CREATEMsgISO8538
        End With
ErrorTrap:
        
End Sub

Private Sub Message_RegToSwitch(ByVal Msisdn As Variant, ByRef Message As String, Optional ByVal FName As Variant, Optional ByVal MName As Variant, Optional ByVal surName As Variant, Optional ByVal National_ID As Variant, Optional ByVal BirthDate As Variant)
    
    Dim PostMsg As New PostBridgeISO8583
    Dim Trace As String
    Trace = ""
    'On Error GoTo ErrorTrap
    'Set PostMsg = New S1BridgeISO8583.PostBridgeISO8583
    
    Stan = Stan + 1
    Ref = Ref + 1
    With PostMsg
        .ResetBitMaps
        
        .MessageTypeID = "0200"
          Trace = "Message type: " & .MessageTypeID & vbNewLine
        
        
         .Pan = "254" & Right(Msisdn, 9): .CreatePBBitMap (2): Trace = Trace & "Field 002: " & .Pan & vbNewLine
         .ProcessingCODE = "910000": .CreatePBBitMap (3): Trace = Trace & "Field 003: " & .ProcessingCODE & vbNewLine
         .AmtTransaction = "000000000000": .CreatePBBitMap (4): Trace = Trace & "Field 004: " & .AmtTransaction & vbNewLine
         .DatetimeTransmission = Format(Month(Date), "00") & Format(Day(Date), "00") & Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (7): Trace = Trace & "Field 007: " & .DatetimeTransmission & vbNewLine
         .SysTraceAuditNum = Format(Stan, "000000"): .CreatePBBitMap (11): Trace = Trace & "Field 011: " & .SysTraceAuditNum & vbNewLine
         .TimeLocTxn = Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (12): Trace = Trace & "Field 012: " & .DateLocTxn & vbNewLine
         .DateLocTxn = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (13): Trace = Trace & "Field 013: " & .TimeLocTxn & vbNewLine
         .DateExpiry = "2012": .CreatePBBitMap (14): Trace = Trace & "Field 014: " & .DateExpiry & vbNewLine
         .DateSettle = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (15): Trace = Trace & "Field 015: " & .DateSettle & vbNewLine
         .MerchantType = "6010": .CreatePBBitMap (18): Trace = Trace & "Field 018: " & .MerchantType & vbNewLine
         .POSEntryMode = "012": .CreatePBBitMap (22): Trace = Trace & "Field 022: " & .POSEntryMode & vbNewLine
         .POSConditionCode = "00": .CreatePBBitMap (25): Trace = Trace & "Field 025: " & .POSConditionCode & vbNewLine
         .POSPinCaptureCode = "04": .CreatePBBitMap (26): Trace = Trace & "Field 026: " & .POSPinCaptureCode & vbNewLine
         '.AmtTxnFee = "D00000000": .CreatePBBitMap (28): Trace = Trace & "Field 028: " & .AmtTxnFee & vbNewLine
         '.AmtTxnProcessingFee = "D00000000": .CreatePBBitMap (30): Trace = Trace & "Field 030: " & .AmtTxnProcessingFee & vbNewLine
         .AcquiringInstIdCode = "625625": .CreatePBBitMap (32): Trace = Trace & "Field 032: " & .AcquiringInstIdCode & vbNewLine
         .ForwardingInstIdCode = "625625": .CreatePBBitMap (33): Trace = Trace & "Field 033: " & .ForwardingInstIdCode & vbNewLine
        '.Track2Data = "" : .CreatePBBitMap (35): Trace = Trace & "Field 035: " & .Track2Data & vbNewLine
         .RetrievalRefNum = Format(Ref, "000000000000"): .CreatePBBitMap (37): Trace = Trace & "Field 037: " & .RetrievalRefNum & vbNewLine
         '.AuthIdResp = "" : .CreatePBBitMap (38): Trace = Trace & "Field 038: " & .AuthIdResp & vbNewLine
         '.RespCode = "" : .CreatePBBitMap (39): Trace = Trace & "Field 039: " & .RespCode & vbNewLine
         '.ServiceRestrictionCode = "" : .CreatePBBitMap (40): Trace = Trace & "Field 040: " & .ServiceRestrictionCode & vbNewLine
         .CardAcceptorTermId = "10102345": .CreatePBBitMap (41): Trace = Trace & "Field 041: " & .CardAcceptorTermId & vbNewLine
         If Len(Merchant_ID) < 15 Then
          .CardAcceptorIdCode = "123456789012347"
          Else
          .CardAcceptorIdCode = Merchant_ID
          End If
          .CreatePBBitMap (42): Trace = Trace & "Field 042: " & .CardAcceptorIdCode & vbNewLine
         
         .CardAcceptorNameLoc = "Supermart 123           Nairobi       KE": .CreatePBBitMap (43): Trace = Trace & "Field 043: " & .CardAcceptorNameLoc & vbNewLine
        ' .AdditionalRespData <> "" : .CreatePBBitMap (44):: Trace = Trace & "Field 044: " & .AdditionalRespData & vbNewLine
         .AdditionalData = "<FName>" & FName & "</FName><MName>" & MName & "</MName><Surname>" & surName & "</Surname><NationalID>" & National_ID & "</NationalID><DateBirth>" & BirthDate & "</DateBirth>": .CreatePBBitMap (48): Trace = Trace & "Field 048: " & .AdditionalData & vbNewLine
         .CurrencyCodeTxn = "404": .CreatePBBitMap (49): Trace = Trace & "Field 049: " & .CurrencyCodeTxn & vbNewLine
        ' .PinData = "12345678": .CreatePBBitMap (52): Trace = Trace & "Field 052: " & "****************" & vbNewLine
        ' .AdditionalAmts <> "" : .CreatePBBitMap (54): Trace = Trace & "Field 054: " & .AdditionalAmts & vbNewLine
        ' .MsgReasonCode = "1506": .CreatePBBitMap (56): Trace = Trace & "Field 056: " & .MsgReasonCode & vbNewLine
         .EchoData = Format(Ref, "000000000000"): .CreatePBBitMap (59): Trace = Trace & "Field 059: " & .EchoData & vbNewLine
        ' .NetMangtInfoCode = "" : .CreatePBBitMap (70): Trace = Trace & "Field 070: " & .NetMangtInfoCode & vbNewLine
        ' .OriginalDataElements <> "" : .CreatePBBitMap (90): Trace = Trace & "Field 090: " & .OriginalDataElements & vbNewLine
        ' .ReplacementAmts <> "" : .CreatePBBitMap (95): Trace = Trace & "Field 095: " & .ReplacementAmts & vbNewLine
         .ReceivingInstIdCode = "": .CreatePBBitMap (100): Trace = Trace & "Field 100: " & .ReceivingInstIdCode & vbNewLine
         .AccIdOne = Msisdn: .CreatePBBitMap (102): Trace = Trace & "Field 102: " & .AccIdOne & vbNewLine
         .AccIdTwo = AuthCode: .CreatePBBitMap (103): Trace = Trace & "Field 103: " & .AccIdTwo & vbNewLine
        ' .POSDataCode = "" : .CreatePBBitMap (123): Trace = Trace & "Field 123: " & .POSDataCode & vbNewLine
        
         
        'Create new message
        Message = .CREATEMsgISO8538
        End With
ErrorTrap:
        
End Sub

Private Sub Message_PINVerifyToSwitch(Optional ByVal Msisdn As String, Optional ByVal AuthCode As String, Optional ByVal GOODSAMNT As String, Optional ByRef strNewMessage As String, Optional ByVal Cashback As String)
    
    Dim PostMsg As New PostBridgeISO8583
    

    Dim Trace As String
    Trace = ""
    'On Error GoTo ErrorTrap
    'Set PostMsg = New S1BridgeISO8583.PostBridgeISO8583
    
    Stan = Stan + 1
    Ref = Ref + 1
    With PostMsg
        .ResetBitMaps
        
        .MessageTypeID = "0200"
          Trace = "Message type: " & .MessageTypeID & vbNewLine
        
        
         .Pan = Msisdn: .CreatePBBitMap (2): Trace = Trace & "Field 002: " & .Pan & vbNewLine
         .ProcessingCODE = "310000": .CreatePBBitMap (3): Trace = Trace & "Field 003: " & .ProcessingCODE & vbNewLine
         .AmtTransaction = Format(GOODSAMNT * 100, "000000000000"): .CreatePBBitMap (4): Trace = Trace & "Field 004: " & .AmtTransaction & vbNewLine
         .DatetimeTransmission = Format(Month(Date), "00") & Format(Day(Date), "00") & Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (7): Trace = Trace & "Field 007: " & .DatetimeTransmission & vbNewLine
         .SysTraceAuditNum = Format(Stan, "000000"): .CreatePBBitMap (11): Trace = Trace & "Field 011: " & .SysTraceAuditNum & vbNewLine
         .TimeLocTxn = Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (12): Trace = Trace & "Field 012: " & .DateLocTxn & vbNewLine
         .DateLocTxn = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (13): Trace = Trace & "Field 013: " & .TimeLocTxn & vbNewLine
         .DateExpiry = "2012": .CreatePBBitMap (14): Trace = Trace & "Field 014: " & .DateExpiry & vbNewLine
         .DateSettle = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (15): Trace = Trace & "Field 015: " & .DateSettle & vbNewLine
         .MerchantType = "6010": .CreatePBBitMap (18): Trace = Trace & "Field 018: " & .MerchantType & vbNewLine
         .POSEntryMode = "012": .CreatePBBitMap (22): Trace = Trace & "Field 022: " & .POSEntryMode & vbNewLine
         .POSConditionCode = "00": .CreatePBBitMap (25): Trace = Trace & "Field 025: " & .POSConditionCode & vbNewLine
         .POSPinCaptureCode = "04": .CreatePBBitMap (26): Trace = Trace & "Field 026: " & .POSPinCaptureCode & vbNewLine
         '.AmtTxnFee = "D00000000": .CreatePBBitMap (28): Trace = Trace & "Field 028: " & .AmtTxnFee & vbNewLine
         '.AmtTxnProcessingFee = "D00000000": .CreatePBBitMap (30): Trace = Trace & "Field 030: " & .AmtTxnProcessingFee & vbNewLine
         .AcquiringInstIdCode = "254": .CreatePBBitMap (32): Trace = Trace & "Field 032: " & .AcquiringInstIdCode & vbNewLine
         .ForwardingInstIdCode = "254": .CreatePBBitMap (33): Trace = Trace & "Field 033: " & .ForwardingInstIdCode & vbNewLine
        '.Track2Data = "" : .CreatePBBitMap (35): Trace = Trace & "Field 035: " & .Track2Data & vbNewLine
         .AuthIdResp = Format(AuthCode, "000000"): .CreatePBBitMap (38)
         .RetrievalRefNum = Format(Ref, "000000000000"): .CreatePBBitMap (37): Trace = Trace & "Field 037: " & .RetrievalRefNum & vbNewLine
         .CardAcceptorTermId = "10102345": .CreatePBBitMap (41): Trace = Trace & "Field 041: " & .CardAcceptorTermId & vbNewLine
         If Len(Merchant_ID) < 15 Then
          .CardAcceptorIdCode = "123456789012347"
          Else
          .CardAcceptorIdCode = Merchant_ID
          End If
          .CreatePBBitMap (42): Trace = Trace & "Field 042: " & .CardAcceptorIdCode & vbNewLine
         
         .CardAcceptorNameLoc = "Supermart 123           Nairobi       KE": .CreatePBBitMap (43): Trace = Trace & "Field 043: " & .CardAcceptorNameLoc & vbNewLine
         .AdditionalRespData = AuthCode: .CreatePBBitMap (44):: Trace = Trace & "Field 044: " & .AdditionalRespData & vbNewLine
         .AdditionalData = AuthCode: .CreatePBBitMap (48): Trace = Trace & "Field 048: " & .AdditionalData & vbNewLine
         .CurrencyCodeTxn = "404": .CreatePBBitMap (49): Trace = Trace & "Field 049: " & .CurrencyCodeTxn & vbNewLine
         .ReceivingInstIdCode = AuthCode: .CreatePBBitMap (100): Trace = Trace & "Field 100: " & .ReceivingInstIdCode & vbNewLine
         .AccIdOne = AuthCode + Right(Msisdn, 9): .CreatePBBitMap (102): Trace = Trace & "Field 102: " & .AccIdOne & vbNewLine
         .AccIdTwo = AuthCode + Right(Msisdn, 9): .CreatePBBitMap (102): Trace = Trace & "Field 103: " & .AccIdTwo & vbNewLine
        ' .POSDataCode = "" : .CreatePBBitMap (123): Trace = Trace & "Field 123: " & .POSDataCode & vbNewLine
        
         
        'Create new message
        strNewMessage = .CREATEMsgISO8538
        End With
ErrorTrap:
        
End Sub


Private Sub Fund_Tranx_Message_ToSwitch(ByVal Msisdn As String, ByVal AuthCode As String, ByVal GOODSAMNT As String, ByRef strNewMessage As String, ByVal TTYPE As String, ByVal County As String, Optional ByVal Cashback As String)
    
    Dim PostMsg As New PostBridgeISO8583
    

    Dim Trace As String
    Trace = ""
    'On Error GoTo ErrorTrap
    'Set PostMsg = New S1BridgeISO8583.PostBridgeISO8583
    
    Stan = Stan + 1
    Ref = Ref + 1
    With PostMsg
        .ResetBitMaps
        
        .MessageTypeID = "0200"
          Trace = "Message type: " & .MessageTypeID & vbNewLine
        
        
         .Pan = "639485035000017280": .CreatePBBitMap (2): Trace = Trace & "Field 002: " & .Pan & vbNewLine
         .ProcessingCODE = "520000": .CreatePBBitMap (3): Trace = Trace & "Field 003: " & .ProcessingCODE & vbNewLine
         .AmtTransaction = GOODSAMNT: .CreatePBBitMap (4): Trace = Trace & "Field 004: " & .AmtTransaction & vbNewLine
         .DatetimeTransmission = Format(Month(Date), "00") & Format(Day(Date), "00") & Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (7): Trace = Trace & "Field 007: " & .DatetimeTransmission & vbNewLine
         .SysTraceAuditNum = Format(Stan, "000000"): .CreatePBBitMap (11): Trace = Trace & "Field 011: " & .SysTraceAuditNum & vbNewLine
         .TimeLocTxn = Format(Hour(Time), "00") & Format(Minute(Time), "00") & Format(Second(Time), "00"): .CreatePBBitMap (12): Trace = Trace & "Field 012: " & .DateLocTxn & vbNewLine
         .DateLocTxn = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (13): Trace = Trace & "Field 013: " & .TimeLocTxn & vbNewLine
         .DateExpiry = "2012": .CreatePBBitMap (14): Trace = Trace & "Field 014: " & .DateExpiry & vbNewLine
         .DateSettle = Format(Month(Date), "00") & Format(Day(Date), "00"): .CreatePBBitMap (15): Trace = Trace & "Field 015: " & .DateSettle & vbNewLine
         .MerchantType = "6010": .CreatePBBitMap (18): Trace = Trace & "Field 018: " & .MerchantType & vbNewLine
         .POSEntryMode = "012": .CreatePBBitMap (22): Trace = Trace & "Field 022: " & .POSEntryMode & vbNewLine
         .POSConditionCode = "00": .CreatePBBitMap (25): Trace = Trace & "Field 025: " & .POSConditionCode & vbNewLine
         .POSPinCaptureCode = "04": .CreatePBBitMap (26): Trace = Trace & "Field 026: " & .POSPinCaptureCode & vbNewLine
         '.AmtTxnFee = "D00000000": .CreatePBBitMap (28): Trace = Trace & "Field 028: " & .AmtTxnFee & vbNewLine
         '.AmtTxnProcessingFee = "D00000000": .CreatePBBitMap (30): Trace = Trace & "Field 030: " & .AmtTxnProcessingFee & vbNewLine
         .AcquiringInstIdCode = "625625": .CreatePBBitMap (32): Trace = Trace & "Field 032: " & .AcquiringInstIdCode & vbNewLine
         .ForwardingInstIdCode = Msisdn: .CreatePBBitMap (33): Trace = Trace & "Field 033: " & .ForwardingInstIdCode & vbNewLine
        '.Track2Data = "" : .CreatePBBitMap (35): Trace = Trace & "Field 035: " & .Track2Data & vbNewLine
         .RetrievalRefNum = Format(Ref, "000000000000"): .CreatePBBitMap (37): Trace = Trace & "Field 037: " & .RetrievalRefNum & vbNewLine
         '.AuthIdResp = "" : .CreatePBBitMap (38): Trace = Trace & "Field 038: " & .AuthIdResp & vbNewLine
         '.RespCode = "" : .CreatePBBitMap (39): Trace = Trace & "Field 039: " & .RespCode & vbNewLine
         '.ServiceRestrictionCode = "" : .CreatePBBitMap (40): Trace = Trace & "Field 040: " & .ServiceRestrictionCode & vbNewLine
         .CardAcceptorTermId = "10102345": .CreatePBBitMap (41): Trace = Trace & "Field 041: " & .CardAcceptorTermId & vbNewLine
         If Len(Merchant_ID) < 15 Then
          .CardAcceptorIdCode = "123456789012347"
          Else
          .CardAcceptorIdCode = Merchant_ID
          End If
          .CreatePBBitMap (42): Trace = Trace & "Field 042: " & .CardAcceptorIdCode & vbNewLine
         
         .CardAcceptorNameLoc = "Supermart 123           Nairobi       KE": .CreatePBBitMap (43): Trace = Trace & "Field 043: " & .CardAcceptorNameLoc & vbNewLine
        ' .AdditionalRespData <> "" : .CreatePBBitMap (44):: Trace = Trace & "Field 044: " & .AdditionalRespData & vbNewLine
         .AdditionalData = AuthCode: .CreatePBBitMap (48): Trace = Trace & "Field 048: " & .AdditionalData & vbNewLine
         .CurrencyCodeTxn = "404": .CreatePBBitMap (49): Trace = Trace & "Field 049: " & .CurrencyCodeTxn & vbNewLine
        ' .PinData = "12345678": .CreatePBBitMap (52): Trace = Trace & "Field 052: " & "****************" & vbNewLine
        ' .AdditionalAmts <> "" : .CreatePBBitMap (54): Trace = Trace & "Field 054: " & .AdditionalAmts & vbNewLine
        ' .MsgReasonCode = "1506": .CreatePBBitMap (56): Trace = Trace & "Field 056: " & .MsgReasonCode & vbNewLine
         .EchoData = Format(Ref, "000000000000"): .CreatePBBitMap (59): Trace = Trace & "Field 059: " & .EchoData & vbNewLine
        ' .NetMangtInfoCode = "" : .CreatePBBitMap (70): Trace = Trace & "Field 070: " & .NetMangtInfoCode & vbNewLine
        ' .OriginalDataElements <> "" : .CreatePBBitMap (90): Trace = Trace & "Field 090: " & .OriginalDataElements & vbNewLine
        ' .ReplacementAmts <> "" : .CreatePBBitMap (95): Trace = Trace & "Field 095: " & .ReplacementAmts & vbNewLine
         .ReceivingInstIdCode = "": .CreatePBBitMap (100): Trace = Trace & "Field 100: " & .ReceivingInstIdCode & vbNewLine
         .AccIdOne = Msisdn: .CreatePBBitMap (102): Trace = Trace & "Field 102: " & .AccIdOne & vbNewLine
         .AccIdTwo = AuthCode: .CreatePBBitMap (103): Trace = Trace & "Field 103: " & .AccIdTwo & vbNewLine
        ' .POSDataCode = "" : .CreatePBBitMap (123): Trace = Trace & "Field 123: " & .POSDataCode & vbNewLine
        
         
        'Create new message
        strNewMessage = .CREATEMsgISO8538
        End With
ErrorTrap:
        
End Sub

